# AI Typeset for Chinawebber

AI Typeset for Chinawebber 是一个针对博大站群（Chinawebber）内容编辑系统（特别是云南大学的站点系统）的Chrome浏览器扩展。该扩展提供AI驱动的一键内容排版功能，提升内容编辑体验并改善格式化质量。

## 📋 目录

- [描述](#描述)
- [目的](#目的)
- [功能](#功能)
- [安装](#安装)
- [使用](#使用)
- [配置](#配置)
- [API接口](#api接口)
- [文件结构](#文件结构)
- [开发](#开发)
- [贡献](#贡献)
- [许可证](#许可证)
- [支持](#支持)

## 描述

一个为云南大学博大站群内容编辑系统设计的AI驱动内容排版Chrome扩展。该扩展会直接在内容编辑页面上提供一键格式化按钮，以及一个通过AI格式化服务进行手动内容处理的完整弹出界面。

## 目的

该扩展的主要目的是通过集成AI排版功能来简化博大站群系统中的内容编辑过程。该扩展满足了改进内容格式和一致性（特别是需要标准格式和正确中文排版的文档，如学术文章、新闻帖子和官方通信）的需求。

## 功能

- **一键排版**：在博大站群内容编辑页面直接添加"一键排版"按钮
- **弹出界面**：提供完整的弹出窗口，包含源内容和格式化内容编辑器
- **API集成**：连接到hiagent API服务以进行AI驱动的内容处理
- **配置**：允许用户通过扩展选项配置API参数
- **视觉反馈**：包含处理指示器和通知系统
- **Monaco编辑器**：使用Monaco编辑器进行语法高亮的内容编辑
- **内容安全**：安全处理API密钥等敏感信息
- **导入/导出**：支持配置导入/导出功能
- **多AI支持**：支持各种AI服务提供商，包括OpenAI、Anthropic、Google和国内提供商

## 安装

### 中文安装

1. 克隆或下载此项目到本地目录
2. 打开Chrome浏览器并导航到 `chrome://extensions/`
3. 在右上角启用"开发者模式"
4. 点击"加载已解压的扩展程序"并选择项目目录
5. 通过选项页面使用您的API凭据配置扩展
6. 扩展现已准备在博大站群页面上使用

## 使用方法

### 中文使用方法

#### 一键排版
1. 导航到博大站群内容编辑页面
2. 点击页面上出现的"一键排版"按钮
3. 等待处理完成（将显示处理指示器）
4. 格式化的内容将自动更新到编辑器中

#### 通过弹出窗口手动处理
1. 点击浏览器工具栏中的扩展图标
2. 点击"获取内容"以从当前编辑器检索内容
3. 点击"AI排版"以使用AI格式化处理内容
4. 在第二个编辑器中查看格式化的内容
5. 点击"复制"以使用格式化的内容更新编辑器

## 配置

### 中文配置

使用前需要使用API凭据配置扩展：

1. 点击工具栏中的扩展图标
2. 选择"选项"或转到 `chrome://extensions/` 并点击扩展下的"选项"
3. 配置以下设置：

- **AI方法**：在OpenAI Completions或HiAgent之间选择
- **HiAgent基础URL**：HiAgent服务基础URL（默认：https://agent.ynu.edu.cn/api/proxy/api/v1）
- **HiAgent应用ID**：您的应用ID
- **HiAgent应用密钥**：您的应用密钥（需要API访问）
- **HiAgent用户ID**：您的用户ID
- **OpenAI基础URL**：OpenAI API基础URL（下拉菜单提供流行提供商）
- **OpenAI API密钥**：您的OpenAI API密钥（需要API访问）
- **模型**：要使用的AI模型（默认：gpt-3.5-turbo）
- **系统提示**：AI格式化的自定义系统提示（多行编辑器）
- **博大站群基础URL**：博大站群系统基础URL（默认：https://sites.ynu.edu.cn）

## API接口

扩展使用两个端点与hiagent API通信：
1. `create_conversation` - 创建对话会话
2. `chat_query_v2` - 使用AI格式处理内容（响应模式：阻塞）

对于OpenAI兼容服务，它使用标准的OpenAI API格式。

## 文件结构

```
ai-typeset-chinawebber/
├── manifest.json          # 扩展配置文件
├── background.js          # 后台服务工作者
├── content.js             # 内容脚本逻辑
├── content.css            # 内容脚本样式
├── popup.html             # 弹出窗口界面
├── popup.js               # 弹出窗口逻辑
├── options.html           # 配置页面
├── options.js             # 配置页面逻辑
├── icon.svg               # 扩展图标
├── icon.png               # 扩展图标（替代格式）
├── modified_openeditor.js # 修改的openeditor函数用于iframe处理
├── _locales/              # 本地化文件
│   ├── en/
│   │   └── messages.json
│   └── zh/
│       └── messages.json
├── README.md              # 项目文档
└── package.json           # 包依赖（如果有的话）
```

## 开发

### 中文开发

要为开发做出贡献：

1. Fork存储库
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 进行更改
4. 提交更改 (`git commit -m 'Add some amazing feature'`)
5. 推送到分支 (`git push origin feature/amazing-feature`)
6. 打开拉取请求

请确保遵循现有的代码样式，如果适用，请包含测试。

## 贡献

### 中文贡献

我们欢迎社区的贡献！无论您是修复错误、添加功能、改进文档还是提出改进建议，您的帮助都会受到赞赏。

贡献方式：
- 报告错误和问题
- 提出新功能
- 改进文档
- 提交拉取请求
- 将扩展翻译为其他语言
- 提供关于可用性的反馈

贡献代码时，请：
- 遵循现有代码样式
- 编写清晰的提交消息
- 添加新功能时包含测试
- 根据需要更新文档

## 许可证

此项目根据MIT许可证授权 - 请参阅[LICENSE](LICENSE)文件了解详细信息。

## 支持

### 中文支持

如果您遇到问题或有疑问：

1. 检查现有的[问题](https://github.com/liudonghua123/ai-typeset-chinawebber/issues)以查看您的问题是否已被报告
2. 如果没有，请创建一个新问题，并提供有关您的问题的详细信息
3. 提供重现问题的步骤
4. 包括您的浏览器版本和扩展版本
5. 如需紧急支持，请直接联系维护者

## 架构说明

### 中文架构说明

扩展使用manifest V2，包含以下组件：

- 使用`chrome.tabs.executeScript`进行内容注入
- `chrome.tabs.query`使用基于回调的方法而不是基于Promise的方法
- 内容脚本处理UI注入和用户交互
- 后台脚本处理API通信
- 弹出窗口提供手动内容处理
- 选项页面用于配置管理