<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    :root {
      --primary-color: #4361ee;
      --success-color: #4caf50;
      --error-color: #f44336;
      --warning-color: #ff9800;
      --gray-100: #f8f9fa;
      --gray-200: #e9ecef;
      --gray-300: #dee2e6;
      --gray-700: #495057;
      --gray-900: #212529;
      --border-radius: 6px;
      --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.2s ease-in-out;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      width: 800px;
      height: 600px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #f5f7fa;
      color: var(--gray-900);
      overflow: hidden;
    }

    .header {
      padding: 20px;
      background: linear-gradient(135deg, var(--primary-color), #3a56d4);
      color: white;
      box-shadow: var(--box-shadow);
      border-radius: 0 0 var(--border-radius) var(--border-radius);
    }

    .header h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .header h1 svg {
      width: 24px;
      height: 24px;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    .execution-time-label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.9);
      margin-left: 10px;
    }

    button {
      padding: 10px 20px;
      background-color: white;
      color: var(--primary-color);
      border: 2px solid white;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 16px rgba(0, 0, 0, 0.15);
    }

    button:disabled {
      background-color: var(--gray-200);
      color: var(--gray-700);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    button.primary {
      background-color: var(--primary-color);
      color: white;
    }

    button.success {
      background-color: var(--success-color);
      color: white;
    }

    .editor-container {
      display: flex;
      height: calc(100% - 100px);
      padding: 5px 10px;
      gap: 20px;
    }

    .editor-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      overflow: hidden;
    }

    .editor-label {
      padding: 5px;
      background-color: var(--gray-100);
      font-weight: 600;
      font-size: 12px;
      border-bottom: 1px solid var(--gray-300);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .editor-label svg {
      width: 16px;
      height: 16px;
    }
    
    .editor-label {
      display: flex !important;
      align-items: center;
      justify-content: space-between;
    }
    
    .editor-label-content {
      display: flex;
      align-items: center;
      flex: 1;
    }
    
    .editor-actions {
      display: flex;
      align-items: center;
      margin-left: auto;
    }
    
    .format-btn, .copy-btn {
      background: transparent;
      border: 1px solid transparent;
      cursor: pointer;
      padding: 6px;
      margin-left: 6px;
      border-radius: 4px;
      opacity: 0.7;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
    }
    
    .format-btn:hover, .copy-btn:hover {
      opacity: 1;
      background-color: rgba(0, 0, 0, 0.1);
      border-color: rgba(0, 0, 0, 0.2);
    }

    .editor-container-wrapper {
      flex: 1;
      position: relative;
    }

    .editor {
      width: 100%;
      height: 100%;
      min-height: 175px; 
      border: none;
      outline: none;
    }

    .editor-placeholder {
      padding: 16px;
      font-family: 'SF Mono', Monaco, 'Courier New', monospace;
      background-color: #fafafa;
      overflow: auto;
      white-space: pre-wrap;
      word-break: break-word;
      font-size: 13px;
      line-height: 1.5;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 20px;
      border-radius: var(--border-radius);
      color: white;
      font-weight: 500;
      z-index: 1000;
      display: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      max-width: 300px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .notification.success {
      background: linear-gradient(135deg, var(--success-color), #43a047);
    }

    .notification.error {
      background: linear-gradient(135deg, var(--error-color), #e53935);
    }

    .notification.warning {
      background: linear-gradient(135deg, var(--warning-color), #fb8c00);
    }

    .processing-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 2000;
      display: none;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(4px);
    }

    .processing-box {
      background: white;
      padding: 30px;
      border-radius: var(--border-radius);
      text-align: center;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      min-width: 250px;
    }

    .spinner {
      border: 4px solid var(--gray-200);
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .processing-text {
      font-size: 16px;
      font-weight: 500;
      color: var(--gray-700);
    }

    /* Syntax highlighting */
    .html-tag {
      color: #0066cc;
      font-weight: 500;
    }

    .html-attr {
      color: #cc6600;
    }

    .html-value {
      color: #009900;
    }

    .html-text {
      color: #333333;
    }

    /* Responsive adjustments */
    @media (max-width: 850px) {
      .editor-container {
        flex-direction: column;
        height: auto;
      }

      body {
        height: auto;
        min-height: 600px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      __MSG_popup_title__
    </h1>
    <div class="header-content">
      <div class="buttons">
        <button id="getContentBtn" class="primary">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
            <path d="M12 16L12 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M8 12L12 8L16 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 6H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          __MSG_get_content_button__
        </button>
        <button id="aiTypesetBtn" disabled>
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
            <path d="M12 2L15.09 8.26L22 9L17 14L18.18 21L12 17.77L5.82 21L7 14L2 9L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          __MSG_ai_typeset_button__
        </button>
        <button id="copyBtn" disabled class="success">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
            <path d="M14 3V7C14 7.26522 14.1054 7.51957 14.2929 7.70711C14.4804 7.89464 14.7348 8 15 8H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M17 21H7C6.46957 21 5.96086 20.7893 5.58579 20.4142C5.21071 20.0391 5 19.5304 5 19V5C5 4.46957 5.21071 3.96086 5.58579 3.58579C5.96086 3.21071 6.46957 3 7 3H17C17.5304 3 18.0391 3.21071 18.4142 3.58579C18.7893 3.96086 19 4.46957 19 5V19C19 19.5304 18.7893 20.0391 18.4142 20.4142C18.0391 20.7893 17.5304 21 17 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 15L11 17L15 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          __MSG_copy_button__
        </button>
      </div>
      <div id="executionTimeLabel" class="execution-time-label" style="display: none;">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
          <path d="M12 8V12L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span id="executionTimeText"></span>
      </div>
    </div>
  </div>

  <div class="editor-container">
    <div class="editor-wrapper">
      <div class="editor-label">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 19.5V4.5C4 3.94772 4.44772 3.5 5 3.5H19C19.5523 3.5 20 3.94772 20 4.5V19.5C20 20.0523 19.5523 20.5 19 20.5H5C4.44772 20.5 4 20.0523 4 19.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M16 7.5H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M16 11.5H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M10 15.5H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <div class="editor-label-content">
          __MSG_source_editor_label__
        </div>
        <div class="editor-actions">
          <button id="formatSourceBtn" class="format-btn" title="格式化HTML">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
              <path d="M12 3V21M9 8L5 12L9 16M15 8L19 12L15 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button id="copySourceBtn" class="copy-btn" title="复制内容">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
              <path d="M11 9H9C7.89543 9 7 9.89543 7 11V19C7 20.1046 7.89543 21 9 21H15C16.1046 21 17 20.1046 17 19V11C17 9.89543 16.1046 9 15 9H13" stroke="currentColor" stroke-width="2"/>
              <path d="M12 3H7C5.89543 3 5 3.89543 5 5V15C5 16.1046 5.89543 17 7 17H12C13.1046 17 14 16.1046 14 15V5C14 3.89543 13.1046 3 12 3Z" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="editor-container-wrapper">
        <div id="sourceEditor" class="editor"></div>
      </div>
    </div>
    <div class="editor-wrapper">
      <div class="editor-label">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <div class="editor-label-content">
          __MSG_formatted_editor_label__
        </div>
        <div class="editor-actions">
          <button id="formatTargetBtn" class="format-btn" title="格式化HTML">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
              <path d="M12 3V21M9 8L5 12L9 16M15 8L19 12L15 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button id="copyTargetBtn" class="copy-btn" title="复制内容">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
              <path d="M11 9H9C7.89543 9 7 9.89543 7 11V19C7 20.1046 7.89543 21 9 21H15C16.1046 21 17 20.1046 17 19V11C17 9.89543 16.1046 9 15 9H13" stroke="currentColor" stroke-width="2"/>
              <path d="M12 3H7C5.89543 3 5 3.89543 5 5V15C5 16.1046 5.89543 17 7 17H12C13.1046 17 14 16.1046 14 15V5C14 3.89543 13.1046 3 12 3Z" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="editor-container-wrapper">
        <div id="formattedEditor" class="editor"></div>
      </div>
    </div>
  </div>

  <div id="notification" class="notification"></div>

  <div id="processingOverlay" class="processing-overlay">
    <div class="processing-box">
      <div class="spinner"></div>
      <div class="processing-text">__MSG_processing_text__</div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>